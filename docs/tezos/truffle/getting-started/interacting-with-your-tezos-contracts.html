<!DOCTYPE html>
<html>
<head>
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-WHT4PS2');</script>
  <!-- End Google Tag Manager -->
  
  <!-- HubSpot Forms -->
  <!--[if lte IE 8]>
    <script charset="utf-8" type="text/javascript" src="//js.hsforms.net/forms/v2-legacy.js"></script>
  <![endif]-->
  <script charset="utf-8" type="text/javascript" src="//js.hsforms.net/forms/v2.js"></script>  <!-- Start of HubSpot Embed Code -->
  <script type="text/javascript" id="hs-script-loader" async defer src="//js.hs-scripts.com/5258293.js"></script>
  <!-- End of HubSpot Embed Code -->  
  <meta charset="utf-8">
  <meta name="description" content="The Truffle suite of tools make dapp development easier and more consistent.">
  
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <!-- Favicon -->
  <link rel="icon" href="/img/favicons/favicon.ico">

  <!-- Add to homescreen for Chrome on Android -->
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="application-name" content="Truffle Suite">
  <link rel="icon" sizes="192x192" href="/img/favicons/chrome-touch-icon-192x192.png">

  <!-- Add to homescreen for Safari on iOS -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="apple-mobile-web-app-title" content="Truffle Suite">
  <link rel="apple-touch-icon" href="/img/favicons/apple-touch-icon.png">

  <!-- Tile icon for Win8/10 (144x144 + tile color) -->
  <meta name="msapplication-TileImage" content="img/favicons/ms-touch-icon-144x144-precomposed.png">
  <meta name="msapplication-TileColor" content="#3372DF">

  <!-- Facebook OpenGraph -->
  <meta property="og:site_name" content="Truffle Suite" />
  <meta property="og:description" content="The Truffle suite of tools make dapp development easier and more consistent." />
  <meta property="og:title" content="Truffle | Interacting with Your Contracts | Documentation | Truffle Suite" />
  <meta property="og:url" content="https://trufflesuite.com/docs/tezos/truffle/getting-started/interacting-with-your-tezos-contracts" />
  <meta property="og:type" content="article" />
  <meta property="og:image" content="https://truffleframework.com/img/favicons/truffle-share.png" />

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="Truffle Suite" />
  <meta name="twitter:title" content="Truffle | Interacting with Your Contracts | Documentation | Truffle Suite" />
  <meta name="twitter:description" content="The Truffle suite of tools make dapp development easier and more consistent." />
  <meta name="twitter:creator" content="Truffle Suite" />
  <meta name="twitter:domain" content="trufflesuite.com" />
  <meta name="twitter:image:src" content="https://truffleframework.com/img/favicons/truffle-share.png" />
  
  <meta name="google-site-verification" content="BSgPkMHzw7IxJTpEElNfD8ZZYPzXgOQiTVPzAxAG8-o" />

  <title>Truffle | Interacting with Your Contracts | Documentation | Truffle Suite</title>

  <link href="https://fonts.googleapis.com/css?family=Grand+Hotel|Open+Sans|Oswald|Varela+Round|Roboto+Condensed|Roboto+Mono" rel="stylesheet">
  <script src="https://kit.fontawesome.com/371f2d7a8a.js" crossorigin="anonymous"></script>
  <link rel="stylesheet" href="/css/index.css?1591034288769">
</head>
<body>
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WHT4PS2"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->
  <nav class="navbar navbar-expand-md navbar-dark fixed-top" id="primaryNav">
    <a class="navbar-brand current" href="/">
      <img class="suite-logo" src="/img/truffle-logomark.svg" alt="Truffle Logo" />TRUFFLE SUITE
    </a>
  
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsExampleDefault" aria-controls="navbarsExampleDefault" aria-expanded="false" aria-label="Toggle navigation">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
  
    <div class="collapse navbar-collapse" id="navbarsExampleDefault">
      <ul class="navbar-nav ml-auto">
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" id="suiteDropdown" href="#" data-toggle="dropdown">SUITE</a>
  
          <div class="dropdown-menu">
            <a class="text-truffle" href="/teams">
              <img class="suite-logo" src="/img/tt-logomark.svg" alt="Truffle Teams Logo" /><span class="narrow">T</span>RUFFLE TEAMS
            </a>
            <a class="text-truffle" href="/truffle">
              <img class="suite-logo" src="/img/truffle-logomark.svg" alt="Truffle Logo" /><span class="narrow">T</span>RUFFLE
            </a>
            <a class="text-ganache" href="/ganache">
              <img class="suite-logo" src="/img/ganache-logomark.svg" alt="Ganache Logo" />Ganache
            </a>
            <a class="text-drizzle" href="/drizzle">
              <img class="suite-logo" src="/img/drizzle-logomark.svg" alt="Drizzle Logo" />dri<span class="drizzle-z-skew-1">z</span><span class="drizzle-z-skew-2">z</span>le
            </a>
          </div>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/docs">DOCS</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/tutorials">TUTORIALS</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/boxes">BOXES</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/blog">BLOG</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/events">EVENTS</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/community">COMMUNITY</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/university">UNIVERSITY</a>
        </li>
      </ul>
    </div>
  </nav>  
  <main role="main" class="container-fluid">
    <!--<div class="row pt-4 pb-4">
      <div class="col">
        <form>
          <div class="row">
            <div class="col">
              <input type="text" class="form-control" id="exampleFormControlInput1" placeholder="ðŸ” Search">
            </div>
            <div class="col">
              <select id="inputState" class="form-control">
                <option selected>4.1</option>
                <option>4.0.6</option>
                <option>4.0.5</option>
              </select>
            </div>
            <div class="col">
              <button type="submit" class="btn btn-truffle">SEARCH</button>
            </div>
          </div>
        </form>
      </div>
    </div>-->

    

    <div class="row row-docs-main">
      <!-- Show the sidebar *only if* we're not directly under /docs (e.g., index, search). --> 

          <aside class="col-lg-3 docs-sidebar" id="docsSidebar">
            <h2 class="space-icon d-lg-none text-center" id="docsSidebarToggle"><i class="fas fa-book"></i> SEARCH &amp; CONTENTS</h2>
          
            <div class="docs-top-nav">
              <a href="/docs">
                <div class="docs-back-button">
                  <i class="fad fa-arrow-square-left"></i>
                </div>
                Tezos
              </a>
            </div>
          
            <div class="docs-wrapper">
          
              <form class="mb-4" id="searchForm">
                <div class="input-group">
                  <input type="text" class="form-control" id="searchInput" placeholder="Search">
                  <div class="input-group-append">
                    <button type="submit" class="btn btn-truffle">SEARCH</button>
                  </div>
                </div>
              </form>
          
              <a class="toggle-truffle suite-link" href="#truffleDocs" data-toggle="collapse">
                <img class="suite-logo" src="/img/truffle-logomark.svg" alt="Truffle Logo" /><h2 class="text-truffle"><span class="narrow">T</span>RUFFLE</h2>
              </a>
          
              <div class="collapse truffle show" id="truffleDocs" data-parent="#docsSidebar">
                <ul>
                  <a href="/docs/tezos/truffle/quickstart"><li>Quickstart</li></a>
                </ul>
                  <h3>Getting Started</h3>
                  <ul>
                      <a href="/docs/tezos/truffle/getting-started/installing-truffle-with-tezos"><li>Installing Truffle with Tezos</li></a>
                      <a href="/docs/tezos/truffle/getting-started/creating-a-tezos-project"><li>Creating a Tezos project</li></a>
                      <a href="/docs/tezos/truffle/getting-started/writing-tezos-contracts"><li>Writing Tezos Contracts</li></a>
                      <a href="/docs/tezos/truffle/getting-started/compiling-tezos-contracts"><li>Compiling Tezos Contracts</li></a>
                      <a href="/docs/tezos/truffle/getting-started/deploying-tezos-contracts"><li>Deploying Tezos Contracts</li></a>
                      <a href="/docs/tezos/truffle/getting-started/interacting-with-your-tezos-contracts"><li>Interacting with Your Tezos Contracts</li></a>
                      <a href="/docs/tezos/truffle/getting-started/testing-your-tezos-contracts"><li>Testing your Tezos Contracts</li></a>
                      <a href="/docs/tezos/truffle/getting-started/using-the-console-with-tezos"><li>Using the Console with Tezos</li></a>
                      <a href="/docs/tezos/truffle/getting-started/writing-external-scripts-with-tezos"><li>Writing External Scripts with Tezos</li></a>
                  </ul>
                  <h3>Reference</h3>
                  <ul>
                      <a href="/docs/tezos/truffle/reference/configuring-tezos-projects"><li>Configuring Tezos Projects</li></a>
                  </ul>
              </div>
          
            </div>
          
          </aside>      
        <div class="col-lg-9 bd-light-cream docs-content">
          <p class="alert alert-danger">
<strong>Tezos support</strong> in Truffle is experimental. Give it a spin, and help us out by <a href="https://github.com/trufflesuite/truffle/issues">filing issues on Github</a>.
</p>


    <h1 class="link-markdown">
      <a class="anchor-target" name="interacting-with-your-contracts"></a>
      <a href="#interacting-with-your-contracts"><i class="fas fa-link"></i></a>
      Interacting with your contracts
    </h1>
  
    <h2 class="link-markdown">
      <a class="anchor-target" name="introduction"></a>
      <a href="#introduction"><i class="fas fa-link"></i></a>
      Introduction
    </h2>
  <p>If you were writing raw requests to the Tezos network yourself in order to interact with your contracts, you&#39;d soon realize that writing these requests is clunky and cumbersome. As well, you might find that managing the state for each request you&#39;ve made is <em>complicated</em>. Fortunately, Truffle takes care of this complexity for you, to make interacting with your contracts a breeze.</p>

    <h2 class="link-markdown">
      <a class="anchor-target" name="making-transactions"></a>
      <a href="#making-transactions"><i class="fas fa-link"></i></a>
      Making Transactions
    </h2>
  <p>Every time you call a function against a contract on the Tezos blockchain, a transaction is recorded. Each transaction will cost you XTZ, the Tezos-specific token that powers the blockchain, and will change the blockchain&#39;s state. Transactions are powerful ways to &quot;write&quot; to the blockchain, and make changes that power the backend of your applications. As you&#39;ll see below, all your contract&#39;s data stored on chain, colloquially called &quot;storage&quot;, is read from the blockchain all at once.</p>

    <h2 class="link-markdown">
      <a class="anchor-target" name="introducing-abstractions"></a>
      <a href="#introducing-abstractions"><i class="fas fa-link"></i></a>
      Introducing abstractions
    </h2>
  <p>Contract abstractions are the bread and butter of interacting with Tezos contracts from Javascript. In short, contract abstractions are wrapper code that makes interaction with your contracts easy, in a way that lets you forget about the many engines and gears executing under the hood. Truffle uses its own contract abstraction via the <a href="https://github.com/trufflesuite/truffle/tree/alphaTez/packages/contract">@truffle/contract</a> module, extended specifically for Tezos, and it is this contract abstraction that&#39;s described below.</p>
<p>In order to appreciate the usefulness of a contract abstraction, however, we first need a contract to talk about. We&#39;ll use the very simple SimpleStorage contract available to you via <code>truffle unbox tezos-example</code> command.</p>
<pre><code>function main (const newValue : int;  const storedValue : int) : (list(operation) * int) is
  block { storedValue := newValue } with ((nil : list(operation)), storedValue)
</code></pre><p>This contract has a single method, or &quot;entry point&quot;, called <code>main()</code>. You&#39;ll notice that the first parameter to <code>main()</code> is an integer that gets stored in the contract&#39;s storage. The second parameter represents current state of the contract&#39;s storage at time of the function execution.</p>
<p>Now let&#39;s look at the Javascript object called <code>SimpleStorage</code> provided for us by Truffle, as made available in the <a href="/docs/tezos/truffle/getting-started/using-the-console-with-tezos">Truffle console</a>:</p>
<pre><code class="lang-javascript">truffle(development)&gt; let instance = await SimpleStorage.deployed()
truffle(development)&gt; instance

// outputs:
//
// Contract
// - address: &quot;KT1AiUNZTnTEbvuSZFcjSEW1V5yB6CW44sHc&quot;
// - main: ()
// - storage: ()
// - send: ()
// ...
</code></pre>
<p>Notice that the abstraction contains the same function you defined in your contract -- <code>main()</code>. It also contains some helper functions (<code>storage()</code> and <code>send()</code>), as well as the address of the contract on-chain.</p>

    <h2 class="link-markdown">
      <a class="anchor-target" name="multi-entrypoint-contracts"></a>
      <a href="#multi-entrypoint-contracts"><i class="fas fa-link"></i></a>
      Multi-Entrypoint Contracts
    </h2>
  <p>As described in the <a href="/docs/tezos/truffle/getting-started/writing-tezos-contracts">Writing Tezos Contracts</a> section, you can define contracts that have multiple entry points. When you create a contract as defined in that section, Truffle does a lot of work to make interacting with that contract easier. Let&#39;s take a look:</p>
<pre><code>// variant defining pseudo multi-entrypoint actions
type action is
| Increment of int
| Decrement of int

function add (const a : int ; const b : int) : int is a + b

function subtract (const a : int ; const b : int) : int is a - b

// real entrypoint that re-routes the flow based on the action provided
function main (const p : action ; const s : int) : (list(operation) * int) is
  ((nil : list(operation)),
    case p of
    | Increment (n) -&gt; add (s, n)
    | Decrement (n) -&gt; subtract (s, n)
    end)
</code></pre><p>If you compile this contract and spin up the console, you&#39;ll see the following when you analyze the abstraction Truffle creates for you:</p>
<pre><code class="lang-javascript">truffle(development)&gt; let instance = await Counter.deployed()
truffle(development)&gt; instance

// outputs:
//
// Contract
// - address: &quot;KT19mnZBa9KCtfv1t47gz9ieKyoxhY8JUvy8&quot;
// - increment: ()
// - decrement: ()
// - storage: ()
// - send: ()
// ...
</code></pre>
<p>In this example, you&#39;ll notice a curious change: <code>main()</code> has been removed, and has been replaced by <code>increment()</code> and <code>decrement()</code>, which were two functions created by Truffle to make it easy to call the entry points defined in your contract.</p>

    <h2 class="link-markdown">
      <a class="anchor-target" name="executing-contract-functions"></a>
      <a href="#executing-contract-functions"><i class="fas fa-link"></i></a>
      Executing contract functions
    </h2>
  <p>Whenever you call contract functions via the abstraction, say <code>main()</code>, <code>increment()</code> or <code>decrement()</code> in the above examples, a transaction request is made against the configured Tezos network. Calling these functions from Javascript will create a transaction on the Tezos blockchain, and make a state change on the blockchain itself. You should consider these functions as &quot;writes&quot;, where executing these functions write data to the blockchain. To perform &quot;reads&quot;, and read storage data, you&#39;ll use the <code>storage()</code> helper function described below.</p>

    <h3 class="link-markdown">
      <a class="anchor-target" name="making-a-transaction"></a>
      <a href="#making-a-transaction"><i class="fas fa-link"></i></a>
      Making a transaction
    </h3>
  <p>Making a transaction is as easy as calling the abstraction functions Truffle provides for you.</p>
<p>To make things easy, let&#39;s start with the SimpleStorage contract defined above. Like before, let&#39;s get the deployed instance of it, but let&#39;s also call the <code>main()</code> function to send the transaction, and then once complete, request the contract&#39;s storage data:</p>
<pre><code class="lang-javascript">truffle(development)&gt; let instance = await SimpleStorage.deployed()
truffle(development)&gt; await instance.main(2)    // Make transaction against main() function
{
  tx: &#39;op8HbSFaHACRQrVZT7SmHjpRwqa9fDVxb6Zjwcyj57jwEgzKpcd&#39;,
  ...
} // transaction output
truffle(development)&gt; await instance.storage()  // Get storage data
BigNumber { s: 1, e: 0, c: [ 2 ] }
</code></pre>
<p>There are a few things interesting about the above code:</p>
<ul>
<li>We called the abstraction&#39;s <code>main()</code> function directly.</li>
<li>When calling the <code>main()</code> function, we only passed on parameter. The second (last) parameter of the <code>main()</code> function is provided by the underlying blockchain, and represents the current storage data of the contract. Because it&#39;s sent to the contract for us, we don&#39;t need to send it from the outside.</li>
<li>We received a transaction response after calling <code>main()</code>, which included a transaction hash (the <code>tx</code> parameter in the response). The transaction hash describe the id of the transaction on the blockchain.</li>
<li>We used the helper function, <code>storage()</code>, to get the storage data of the contract. The data of this particular contract is an integer, and in Javascript is represented by the BigNumber object, in this case with the value of <code>2</code>. This happens to be the value we sent to <code>main()</code> within our transaction!</li>
</ul>
<p>This is all well and good. Now let&#39;s try it with a multi-entrypoint contract:</p>
<pre><code class="lang-javascript">truffle(development)&gt; let instance = await Counter.deployed()
truffle(development)&gt; await instance.increment(2)    // Make transaction against increment() entry point
{
  tx: &#39;onsbwiB8HK9heBmcJAHRvadcH435waNPpKAMMMGLsiEYXRhtqhx&#39;,
  ...
} // transaction output
truffle(development)&gt; await instance.storage()  // Get storage data
BigNumber { s: 1, e: 0, c: [ 3 ] }
</code></pre>
<p>This is very similar to the example above, except in this case we didn&#39;t call <code>main()</code>. We instead called one of the named entry points, <code>increment()</code>, and it was treated as a transaction, exactly as if we had called <code>main()</code>.</p>

    <h3 class="link-markdown">
      <a class="anchor-target" name="reading-contract-data"></a>
      <a href="#reading-contract-data"><i class="fas fa-link"></i></a>
      Reading contract data
    </h3>
  <p>As shown into the examples above, we can read the contract&#39;s data through the <code>storage()</code> function:</p>
<pre><code class="lang-javascript">truffle(development)&gt; let instance = await SimpleStorage.deployed()
truffle(development)&gt; await instance.storage()  // Get storage data
BigNumber { s: 1, e: 0, c: [ 2 ] }
</code></pre>
<p>What&#39;s interesting here:</p>
<ul>
<li>We received a return value. Note that since the Ethereum network can handle very large numbers, we&#39;re given a <a href="https://github.com/MikeMcl/bignumber.js/">BigNumber</a> object which we can then convert to a number. The BigNumber library is used because Tezos can represent larger numbers than are allowed natively by Javascript.</li>
</ul>
<p class="alert alert-warning">
<strong>Warning</strong>: If you try to convert a BigNumber that&#39;s larger than the largest integer supported by Javascript, you&#39;ll likely run into errors or unexpected behavior. We suggest using BigNumber throughout your application.
</p>

<p>Note that the data you get back from the <code>storage()</code> function will represent the types and structure of the underlying data stored in your contract. Let&#39;s take a new example we haven&#39;t seen yet:</p>
<pre><code>// ExpandedStorage.ligo - much like SimpleStorage, but stores two values!
type values is record
  firstValue : int;
  secondValue : int;
end
function main (const newValues : values;  const storedValues : values) : (list(operation) * values) is
  block { storedValues := newValues } with ((nil : list(operation)), storedValues)
</code></pre><p>In this contract, the contract&#39;s storage is represented by a LIGO record object that contains two integers, the first named <code>firstValue</code>, and the second named <code>secondValue</code>. When you call <code>storage()</code> from the Truffle console, you&#39;ll see you&#39;re given data that respresents the same structure:</p>
<pre><code class="lang-javascript">truffle(development)&gt; let instance = await ExpandedStorage.deployed()
truffle(development)&gt; await instance.storage()  // Get storage data
{
  firstValue: BigNumber { s: 1, e: 0, c: [ 3 ] },
  secondValue: BigNumber { s: 1, e: 0, c: [ 3 ] }
}
</code></pre>

    <h3 class="link-markdown">
      <a class="anchor-target" name="add-a-new-contract-to-the-network"></a>
      <a href="#add-a-new-contract-to-the-network"><i class="fas fa-link"></i></a>
      Add a new contract to the network
    </h3>
  <p>In the above cases, we&#39;ve been using a contract abstraction that has already been deployed through Truffle&#39;s deployment system. You can deploy new contracts to the network within your own code by using <code>.new()</code> function provided by the top-level abstraction object:</p>
<pre><code class="lang-javascript">truffle(developmnet)&gt; let newInstance = await SimpleStorage.new(3) // Deploy a new version of SimpleStorage
truffle(development)&gt; newInstance.address
&#39;KT1Rt8CozyFb1HFhdkK7BLEcURsCtMxCYs1b&#39;
truffle(development)&gt; await newInstance.storage()
BigNumber { s: 1, e: 0, c: [ 3 ] }
</code></pre>

    <h3 class="link-markdown">
      <a class="anchor-target" name="use-a-contract-at-a-specific-address"></a>
      <a href="#use-a-contract-at-a-specific-address"><i class="fas fa-link"></i></a>
      Use a contract at a specific address
    </h3>
  <p>If you already have an address for a contract stored externally, you can create a new abstraction to represent the contract at that address, using the <code>at()</code> function provided by the top-level abstraction object:</p>
<pre><code class="lang-javascript">truffle(development)&gt; let specificInstance = await SimpleStorage.at(&quot;KT1Rt8CozyFb1HFhdkK7BLEcURsCtMxCYs1b&quot;);
truffle(development)&gt; await newInstance.storage()
BigNumber { s: 1, e: 0, c: [ 3 ] }
</code></pre>

    <h2 class="link-markdown">
      <a class="anchor-target" name="further-reading"></a>
      <a href="#further-reading"><i class="fas fa-link"></i></a>
      Further reading
    </h2>
  <p>The contract abstractions provided by Truffle wouldn&#39;t have been possible without the amazing <a href="https://tezostaquito.io/">Taquito library</a> that does a lot of the heavy lifing for what you see above. Check out <a href="https://tezostaquito.io/docs/quick_start">their documentation</a> for more information.</p>


          <div class="contribute-link">
            See a way to make this page better? <a href="https://github.com/trufflesuite/trufflesuite.com/edit/master/src/docs/tezos/truffle/getting-started">Edit here &raquo;</a>
          </div>        </div>
    </div>
  </main>

  <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
  <script>window.jQuery || document.write('<script src="/js/vendor/jquery-3.2.1.slim.min.js"><\/script>')</script>
  <script src="/js/bootstrap.min.js"></script>
  <script src="/js/vendor/prism.js"></script>
  <script async defer src="https://buttons.github.io/buttons.js"></script>
  <script src="/js/docs.js"></script>
  <script src="https://unpkg.com/lunr/lunr.js"></script>
  <script src="/js/docs-search.js"></script>
</body>
</html>