<!DOCTYPE html>
<html>
<head>
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-WHT4PS2');</script>
  <!-- End Google Tag Manager -->
  
  <!-- HubSpot Forms -->
  <!--[if lte IE 8]>
    <script charset="utf-8" type="text/javascript" src="//js.hsforms.net/forms/v2-legacy.js"></script>
  <![endif]-->
  <script charset="utf-8" type="text/javascript" src="//js.hsforms.net/forms/v2.js"></script>  <!-- Start of HubSpot Embed Code -->
  <script type="text/javascript" id="hs-script-loader" async defer src="//js.hs-scripts.com/5258293.js"></script>
  <!-- End of HubSpot Embed Code -->  
  <meta charset="utf-8">
  <meta name="description" content="The Truffle suite of tools make dapp development easier and more consistent.">
  
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    
  <!-- Favicon -->
  <link rel="icon" href="/img/favicons/favicon.ico">

  <!-- Add to homescreen for Chrome on Android -->
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="application-name" content="Truffle Suite">
  <link rel="icon" sizes="192x192" href="/img/favicons/chrome-touch-icon-192x192.png">

  <!-- Add to homescreen for Safari on iOS -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="apple-mobile-web-app-title" content="Truffle Suite">
  <link rel="apple-touch-icon" href="/img/favicons/apple-touch-icon.png">

  <!-- Tile icon for Win8/10 (144x144 + tile color) -->
  <meta name="msapplication-TileImage" content="img/favicons/ms-touch-icon-144x144-precomposed.png">
  <meta name="msapplication-TileColor" content="#3372DF">

  <!-- Facebook OpenGraph -->
  <meta property="og:site_name" content="Truffle Suite" />
  <meta property="og:description" content="The Truffle suite of tools make dapp development easier and more consistent." />
  <meta property="og:title" content="Open call for contributions by Truffle + PegaSys: EEA private transactions | Blog | Truffle Suite" />
  <meta property="og:url" content="https://trufflesuite.com/blog/open-call-for-contributions-truffle-pegasys-eea-private-transactions" />
  <meta property="og:type" content="article" />
  <meta property="og:image" content="https://truffleframework.com/img/favicons/truffle-share.png" />

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="Truffle Suite" />
  <meta name="twitter:title" content="Open call for contributions by Truffle + PegaSys: EEA private transactions | Blog | Truffle Suite" />
  <meta name="twitter:description" content="The Truffle suite of tools make dapp development easier and more consistent." />
  <meta name="twitter:creator" content="Truffle Suite" />
  <meta name="twitter:domain" content="trufflesuite.com" />
  <meta name="twitter:image:src" content="https://truffleframework.com/img/favicons/truffle-share.png" />
  
  <meta name="google-site-verification" content="BSgPkMHzw7IxJTpEElNfD8ZZYPzXgOQiTVPzAxAG8-o" />
    
  <title>Open call for contributions by Truffle + PegaSys: EEA private transactions | Blog | Truffle Suite</title>

  <link href="https://fonts.googleapis.com/css?family=Grand+Hotel|Open+Sans|Oswald|Varela+Round|Roboto+Condensed|Roboto+Mono" rel="stylesheet">
  <script src="https://kit.fontawesome.com/371f2d7a8a.js" crossorigin="anonymous"></script>
  <link rel="stylesheet" href="/css/index.css">
</head>
<body>
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WHT4PS2"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->  
  <nav class="navbar navbar-expand-md navbar-dark fixed-top" id="primaryNav">
    <a class="navbar-brand current" href="/">
      <img class="suite-logo" src="/img/truffle-logomark.svg" alt="Truffle Logo" /><span class="d-none d-lg-block">TRUFFLE SUITE</span>
    </a>
  
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsExampleDefault" aria-controls="navbarsExampleDefault" aria-expanded="false" aria-label="Toggle navigation">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
  
    <div class="collapse navbar-collapse" id="navbarsExampleDefault">
      <ul class="navbar-nav ml-auto">
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" id="suiteDropdown" href="#" data-toggle="dropdown">SUITE</a>
  
          <div class="dropdown-menu">
            <a class="text-truffle" href="/teams">
              <img class="suite-logo" src="/img/tt-logomark.svg" alt="Truffle Teams Logo" /><span class="narrow">T</span>RUFFLE TEAMS
            </a>
            <a class="text-truffle" href="/truffle">
              <img class="suite-logo" src="/img/truffle-logomark.svg" alt="Truffle Logo" /><span class="narrow">T</span>RUFFLE
            </a>
            <a class="text-ganache" href="/ganache">
              <img class="suite-logo" src="/img/ganache-logomark.svg" alt="Ganache Logo" />Ganache
            </a>
            <a class="text-drizzle" href="/drizzle">
              <img class="suite-logo" src="/img/drizzle-logomark.svg" alt="Drizzle Logo" />dri<span class="drizzle-z-skew-1">z</span><span class="drizzle-z-skew-2">z</span>le
            </a>
          </div>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/docs">DOCS</a>
        </li>
        <li class="nav-item">
          <a class="nav-link trufflecon-link" href="/trufflecon2020">TRUFFLEC<img src="/img/truffle-logomark.svg" alt="Truffle Logo"/>N</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/tutorials">TUTORIALS</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/boxes">BOXES</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/blog">BLOG</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/events">EVENTS</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/community">COMMUNITY</a>
        </li>
      </ul>
    </div>
  </nav>
  <main class="container container-heading container-narrow">
    <div class="row">
      <div class="col">
        <h1>Open call for contributions by Truffle + PegaSys: EEA private transactions</h1>
        <ul class="list-sm-stacker space-icon mb-0">
          <li><i class="far fa-calendar-alt"></i> 2019-7-24&nbsp;&nbsp;&nbsp;</li>
          <li><i class="far fa-user"></i> Felipe Faraggi, Guest Blogger, Developer Evangelist from PegaSys</li>
        </ul>
      </div>
    </div>
  </main>

  <main class="banner banner-light-cream pt-5 pb-5" role="main">
    <div class="container container-post">
      <div class="row justify-content-center">
        <div class="col">
          
    <h1 class="link-markdown">
      <a class="anchor-target" name="open-call-for-contributions-by-truffle-pegasys-eea-private-transactions"></a>
      <a href="#open-call-for-contributions-by-truffle-pegasys-eea-private-transactions"><i class="fas fa-link"></i></a>
      Open call for contributions by Truffle + PegaSys: EEA private transactions
    </h1>
  <p>
    <img class="img-fluid" src="https://i.imgur.com/GLw8iok.jpg" title="Pegasys Truffle Open Call For Contributions" alt="Pegasys Truffle Open Call For Contributions" />
    
  </p>

    <h2 class="link-markdown">
      <a class="anchor-target" name="what-39-s-missing-"></a>
      <a href="#what-39-s-missing-"><i class="fas fa-link"></i></a>
      What&#39;s missing?
    </h2>
  <p>In its current state, Truffle doesn&#39;t support EEA private transactions. Support for the web3js-eea library is needed for this to work and PegaSys has recently made an implementation of the v4.0 EEA specification.</p>

    <h2 class="link-markdown">
      <a class="anchor-target" name="why-did-this-happen-"></a>
      <a href="#why-did-this-happen-"><i class="fas fa-link"></i></a>
      Why did this happen?
    </h2>
  <p>The <code>interface-adapter</code> in Truffleâ€™s codebase doesnâ€™t provide an adapter for the  EEA 4.0 client spec, therefore private transactions arenâ€™t working.</p>
<p>The EEA client specification is a developing specification and  Truffle has not yet implemented the EEA client specification around private transactions.  PegaSys is providing an implementation of the specification for private transactions.  Pegasys and Truffle are teaming up to ensure that Truffle supports the EEA JSON RPC API methods.</p>

    <h2 class="link-markdown">
      <a class="anchor-target" name="what-39-s-the-solution-"></a>
      <a href="#what-39-s-the-solution-"><i class="fas fa-link"></i></a>
      What&#39;s the solution?
    </h2>
  <p>PegaSys and Truffle have teamed up to make a single open call for contributions. This guest blog post is made by the PegaSys team and is to be posted on the Truffle blog and promoted by both teams in order to add code to Truffle codebase to add support for them.</p>
<p>The solution involves using a Delegation pattern to help make that work.</p>
<p>The location of the files to be modified can be found here:
<a href="https://github.com/trufflesuite/truffle/tree/develop/packages/interface-adapter/lib">truffle/packages/interface-adapter/lib</a></p>
<p>In short, when Truffle receives a transaction, it should determine if its a <code>privateFor</code> transaction. If so, it would delegate the rest of the business logic to the EEA library. If not, it should just continue processing the transaction with the original web3 methods.</p>
<p>Also, it would be very useful to make sure this plays nicely with the getTransactionReceipt methods later in the chain of events.</p>

    <h2 class="link-markdown">
      <a class="anchor-target" name="what-to-do-exactly-"></a>
      <a href="#what-to-do-exactly-"><i class="fas fa-link"></i></a>
      What to do Exactly?
    </h2>
  <p>The initial process involves adding an EEA definition to the shim file. The <code>web3-shim.ts</code> file currently contains the overloads for the different interface definitions and their mappings.</p>
<pre><code class="language-typescript">import { EthereumDefinition } from &quot;./ethereum-overloads&quot;;
import { QuorumDefinition } from &quot;./quorum-overloads&quot;;
import { FabricEvmDefinition } from &quot;./fabric-evm-overloads&quot;;

const initInterface = async(web3Shim: Web3Shim) =&gt; {

    const networkTypes: NetworkTypesConfig = new Map(Object.entries({
      &quot;ethereum&quot;: EthereumDefinition,
      &quot;quorum&quot;: QuorumDefinition,
      &quot;fabric-evm&quot;: FabricEvmDefinition
    }));

    networkTypes.get(web3Shim.networkType).initNetworkType(web3Shim);
  }</code></pre>
<p>The initial import and mapping has been done <a href="https://github.com/faraggi/truffle">in this fork</a>.</p>
<pre><code class="language-typescript">import { EthereumDefinition } from &quot;./ethereum-overloads&quot;;
import { EEADefinition } from &quot;./EEA-overloads&quot;;
import { QuorumDefinition } from &quot;./quorum-overloads&quot;;
import { FabricEvmDefinition } from &quot;./fabric-evm-overloads&quot;;

const initInterface = async(web3Shim: Web3Shim) =&gt; {

    const networkTypes: NetworkTypesConfig = new Map(Object.entries({
      &quot;ethereum&quot;: EthereumDefinition,
      &quot;EEA&quot;: EEADefinition,
      &quot;quorum&quot;: QuorumDefinition,
      &quot;fabric-evm&quot;: FabricEvmDefinition
    }));

    networkTypes.get(web3Shim.networkType).initNetworkType(web3Shim);
  }</code></pre>
<p>The <a href="https://i.imgur.com/4fVoQoQ.png">rest of the owl</a> is to add the needed logic in the <code>eea-overloads.ts</code> file and the <code>overrides</code> variable for it to interact with the <a href="https://www.npmjs.com/package/web3-eea">web3eeajs library</a>.</p>
<p>
    <img class="img-fluid" src="https://i.imgur.com/4fVoQoQ.png" title="PegaSys owl" alt="PegaSys owl" />
    
  </p>

    <h2 class="link-markdown">
      <a class="anchor-target" name="who-can-do-this-"></a>
      <a href="#who-can-do-this-"><i class="fas fa-link"></i></a>
      Who can do this?
    </h2>
  <p>Anyone who&#39;d like to try can very much do so we will gladly support any developer who wants to help out.
But here are some recommended prerequisites:</p>
<p>The Truffle codebase is mainly written in <code>javascript</code>, and this particular interface-adapter library we&#39;ll be looking at is written in <code>typescript</code>.
So knowing some javascript is a must.</p>
<p>It will definitely help if you&#39;ve had some exposure and usage of the Truffle library. Nothing fancy, just using it for compiling and deploying contracts for example.
Likewise, having some previous knowledge of the web3js library is going to prove quite helpful.</p>
<p>All of the above somewhat describes a general dapp developer- so in other words; if you&#39;ve already written a dapp before using Truffle, this contribution could be done by you.</p>
<p>So what&#39;s in it for you?
Two things:</p>
<ul>
<li>You&#39;ll receive some ðŸ˜Ž PegaSys Swag!</li>
<li>We&#39;ll personally thank and credit you on stage at <a href="https://twitter.com/trufflesuite/status/1150929297647034374">Trufflecon at my Permissioning  Talk</a></li>
</ul>
<p>For more information or help on this contribution, contact <a href="mailto:felipe.faraggi@consensys.net">Felipe</a> from <a href="http://pegasys.tech">PegaSys</a>,  or write us on <a href="https://gitter.im/PegaSysEng/pantheon">our gitter channel</a>.</p>


          <div class="contribute-link">
            See a way to make this page better? <a href="https://github.com/trufflesuite/trufflesuite.com/edit/develop/src/blog">Edit here &raquo;</a>
          </div>        </div>
      </div>
    </div>
  </main>

  <footer>
    <div class="container">
      <div class="row">
        <div class="col-12 col-md-2 mb-4 mb-md-0">
          <img class="truffle-logo" src="/img/truffle-logo-light.svg" alt="Truffle Logo" />
        </div>
  
        <div class="col-12 col-md-5 mb-3 mb-md-0">
          <ul>
            <li><a href="mailto:inquiry@trufflesuite.com">CONTACT US</a></li>
            <li><a href="/policy">PRIVACY POLICY</a></li>
            <li><a href="/press-releases">PRESS RELEASES</a></li>
            <li><a href="/staff">STAFF</a></li>
            <li><a href="/dashboard">DASHBOARD</a></li>
            <li><a href="https://github.com/trufflesuite">GITHUB</a></li>
            <li><a class="trufflecon-link" href="https://www.trufflesuite.com/trufflecon2020">TRUFFLEC<img src="/img/truffle-logomark.svg" alt="Truffle Logo" /><span>O</span>N 2020</a></li>
            <li><strong>&copy; Truffle Blockchain Group 2020</strong></li>
          </ul>
  
          <ul class="list-inline h4 ">
            <li class="list-inline-item mb-0"><a href="https://www.reddit.com/r/truffle"><i class="fab fa-reddit-square"></i></a></li>
            <li class="list-inline-item mb-0"><a href="https://twitter.com/trufflesuite"><i class="fab fa-twitter-square"></i></a></li>
            <li class="list-inline-item mb-0"><a href="https://www.facebook.com/trufflesuite/"><i class="fab fa-facebook-square"></i></a></li>
            <li class="list-inline-item mb-0"><a href="https://www.instagram.com/truffledevsuite/"><i class="fab fa-instagram"></i></a></li>
            <li class="list-inline-item mb-0"><a href="https://www.linkedin.com/company/trufflesuite/"><i class="fab fa-linkedin"></i></a></li>
            <li class="list-inline-item mb-0"><a href="https://www.youtube.com/channel/UCo2cy2Z7_91zPJSrb6NWfSw"><i class="fab fa-youtube-square"></i></a></li>
          </ul>
        </div>
  
        <div class="col-12 col-md-5">
          <h4>SIGN UP FOR THE TRUFFLE MAILING LIST</h4>
          <script>
            hbspt.forms.create({
            Â  Â portalId: "5258293",
            Â  Â formId: "afcfabf3-e2c3-4a08-aace-ef5c7b13c3d8"
            });
          </script>
        </div>
      </div>
    </div>
  </footer>
  <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
  <script>window.jQuery || document.write('<script src="/js/vendor/jquery-3.2.1.slim.min.js"><\/script>')</script>
  <script src="/js/bootstrap.min.js"></script>
  <script src="/js/vendor/prism.js"></script>
  <script src="/js/markdown-cleanup.js"></script>
</body>
</html>